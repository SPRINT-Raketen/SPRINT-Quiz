<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>Quiz Page</title>
        <link rel = "stylesheet" href = "css/quizStyle.css">
        <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

        <script src="js/script.js"></script>


        <!-- Ergänzung von Markus --> 
        <script>
            // Link zum JSON-Objekt. Vorläufig statisch, später irgendwie mit API
            const json_url = 'https://raw.githubusercontent.com/SPRINT-Raketen/SPRINT-Quiz/frontend/assn3/frontend/dummyQuestion01.json';
            
            /*
            Pseudo-JSON, zum Üben (Stand 08.03.21)
            const json_url = '{"id":0,"level": 0,"subject": "dummyTest","question": "Wieviele Beine hat eine Katze?","answers": ["vier Beine", "3 Beine","7 Flügel","weiss nicht"]}';
            */ 

            var json_obj_global;
            var parsedJSON_global;

            //generiert Anfrage an API mit Parametern Level, subject etc.
            function buildAPIrequest (){};

            //holt JSON-Objekt ab (vorläufig auf GitHub, später beim API)
            function getJSON (){
                fetch(json_url)
                .then(response => {
                    if (response.status === 200) {    // okay
                        const json_obj = response.json();   // consume json, only once possible!
                        console.log("json to var - return now");
                        return json_obj;    // return consumed json to second .then() 
                    } else {    // nok, so print error
                        alert(response.status.toString() + ": " + response.statusText);
                    }
                })

                //Diesen Teil will ich eigentlich in parseJSON und distributeJSONcontent auslagern, klappt aber noch nicht.
                .then(myJson => { // lambda to manage consumed jso
                    var parsedJSON = myJson; 
                    document.getElementById("question_text").innerHTML   = parsedJSON.question;
                    document.getElementById("level").innerHTML   = parsedJSON.level;
                    document.getElementById("subject").innerHTML    = parsedJSON.subject;
                    document.getElementById("answer_a").innerHTML   = parsedJSON.answers[0];
                    document.getElementById("answer_b").innerHTML   = parsedJSON.answers[1];
                    document.getElementById("answer_c").innerHTML   = parsedJSON.answers[2];
                    document.getElementById("answer_d").innerHTML   = parsedJSON.answers[3];
                })
            }

            //JSON parsen
            function parseJSON (json_obj){
                document.getElementById("answer3").innerHTML    = "parseJSON: VOR parse"; //nur zur Kontrolle
                var parsedJSON_lokal = JSON.parse(json_obj);
                document.getElementById("answer4").innerHTML    = "parseJSON: NACH parse"; //nur zur Kontrolle
                return parsedJSON_lokal;
            }
        
            //JSON-Inhalte auf verschiedene Felder verteilen
            function distributeJSONcontent (parsedJSON){
                document.getElementById("question").innerHTML   = parsedJSON.question;
                document.getElementById("subject").innerHTML    = parsedJSON.subject;
                document.getElementById("answer_a").innerHTML   = parsedJSON.answers[0];
                document.getElementById("answer_b").innerHTML   = parsedJSON.answers[1];
                document.getElementById("answer_c").innerHTML   = parsedJSON.answers[2];
                document.getElementById("answer_d").innerHTML   = parsedJSON.answers[3];
            }

            //alle Schritte zusammen ausführen (neue Frage requesten, JSON aufnehmen, Inhalte anzeigen)
            function showNewQuestion (){
                //buildAPIrequest ();
                json_obj_global= getJSON();
                //parsedJSON_global=parseJSON (json_obj_global);
                //distributeJSONcontent(parsedJSON_global);
            }



            /*Was fehlt noch:
                a) Der Ablauf ist momentan holprig, weil sich die Ansätze in die Quere kommenn.
                    Momentan:S
                        0. Index: Klick "Start Quiz" -> Wechsel zu Quizbildschirm
                        1. klick "neue Frage anzeigen" -> vordefinierte Frage taucht auf
                        2. klick "Frage aus pseudo..." -> Frage aus JSON taucht auf
                    mE Sinnvoller:
                        0. Index: Klick "Start Quiz" -> Wechsel zu Quizbildschirm, erste Frage wird schon angezeigt
                                                        dh im Hintergrund muss schon eine JSON-Abfrage passieren
                        1. buttons/Funktionen "submit","Neue Frage anzeigen","Frage aus pseudo..." zusammenführen
                            zB klick auf "submit" lädt im Hintergrund neues JSON, zeigt Inhalte an etc.
                
                b) Das JSONS-Script wechselt noch nicht zur nächsten Frage, es lädt immer das gleiche JSON
            */
        </script>
        
        <script src="js/quiz.js"></script>
    </head>

    <body>
        <img src = "millionen-quiz.png" width = "200" height="191" alt = "SPRINT-Quiz">
        <p></p>

        <section id="quiz1" style="display: none">
            <form id="quiz" name="quiz" method="" action="">

                <h3>Frage <span id="qno">0</span></h3>
                <h1 id="question_text">Frage?</h1>
                <h1>Level: <span id="level">Platzhalter level</span></h1>
                              
                <!-- Ergänzung von Markus --> 
                <h3>subject: <span id="subject">Platzhalter subject</span></h3>

                <div>
                    <input type="radio" id="answers_a" name="answers" value="A" onchange="checkAnswer(this)">
                    <label for="answers_a"><span id="answer_a">Antwort A</span></label>

                    <input type="radio" id="answers_b" name="answers" value="B" onchange="checkAnswer(this)">
                    <label for="answers_b"><span id="answer_b">Antwort B</span></label>
                    <p></p>
                    <input type="radio" id="answers_c" name="answers" value="C" onchange="checkAnswer(this)">
                    <label for="answers_c"><span id="answer_c">Antwort C</span></label>

                    <input type="radio" id="answers_d" name="answers" value="D" onchange="checkAnswer(this)">
                    <label for="answers_d"><span id="answer_d">Antwort D</span></label>
                </div>
            </form>
        </section>
        
        <p></p>
        <p><button id="continue"  onclick="ShowAndHide(); showQuestion()">Neue Frage anzeigen</button></p>       
        <p> </p>
        <button><a href = "index.html" title ="Start Page">Zur Startseite zurück</a></body></button>
        
        <!-- Ergänzung von Markus --> 
        <p></p>
        <button onclick="showNewQuestion ()">Frage aus JSON laden (JSON wird später mal von API requested)</button> <p></p>
        <button><a href = "results.html" title ="Anzeige der aktuellen Punkte">PROVISORISCH: results (=aktueller Punktestand)</a></body></button> <p></p>
        <button><a href = "congratulation.html" title ="Anzeige bei erfolgreichen Abschluss des Quiz">PROVISORISCH: Gratulationsbildschirm</a></body></button>
    </body>

</html>


